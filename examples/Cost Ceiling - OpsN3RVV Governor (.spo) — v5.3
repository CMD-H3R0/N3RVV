# ⚡ N3RVV Spark Portable Object (.spo) — v5.3
# Example: AWS Cost Ceiling — OpsN3RVV Governor
# License: CC-BY-NC

ignition:
  spark_id: "spk.gateway.intake.2025-08-30t21-44-12z.001"
  name: "AWS Cost Ceiling — OpsN3RVV Governor"
  description: "Enforce a monthly AWS spend ceiling; throttle non-critical workloads as the ceiling approaches."
  aliases: ["cost cap", "budget guardrail", "spend governor"]

spark:
  metadata:
    origin: "voice_input"                  # voice_input | text_capture | reticle_edit | sil_generated | api | import
    created_at: "2025-08-30T21:44:12Z"
    source_device: "rayban_meta_glasses"
    type: "decision"                       # idea | task | note | insight | research | design | decision
    environment: "project_n3rvv"           # personal | work | shared | project_*
    sovereignty: "private"                 # private | shielded | public
    tags: ["aws","ops","governance","costs"]
    watermark:
      generator: "gateway"
      n3rvv_version: "7.2"
      schema_version: "5.3"
      build_id: "gw-81a2f6"
    integrity:
      etag: "c0ffeeadbeefc0ffeeadbeefc0ffeeadbeef"
      checksum_algo: "sha256"
    provenance:
      author: "nomad"
      contributors: ["opsn3rvv","sil"]
      imported_from: null
      chain_anchor:
        network: "ethereum"
        txid: "0x9e1f3b3a4f2d1e0a7b0c9d...ab"
        hash: "b2f5ff47436671b6ff..."

  payload:
    content: |
      Define a monthly AWS cost ceiling (e.g., $150) for MVP "Spark Vault Lite".
      OpsN3RVV monitors Cost Explorer/Athena and throttles non-critical jobs when projected spend ≥ 85% of ceiling.
      Hard block non-essential execution at 100% until manual override.
    context: "Region: us-east-1; Accounts: n3rvv-mvp-root + dev sub-accounts."
    attachments:
      # Small assets inline (images, icons). Cap recommended ≤ 2 MB.
      - kind: "embedded"
        name: "governor-diagram.png"
        mime: "image/png"
        size_bytes: 184332
        sha256: "3fe2ab7d3c4e9b6d0c9f...c9d1"
        base64: "iVBORw0KGgoAAAANSUhEUgAA...BASE64_TRUNCATED..."
        thumbnail: null

      # Large binaries via URI (S3/IPFS/etc.) with content-hash for sovereignty.
      - kind: "external"
        name: "draft_cost_model.xlsx"
        mime: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
        uri: "s3://n3rvv-artifacts/costs/2025-08/draft_cost_model.xlsx"
        size_bytes: 7340032
        sha256: "a9f1b2c3d4e5...e1aa"
        rights: "CC-BY-NC"
        sensitivity: "none"                 # none | pii | secret
        encryption:
          at_rest: true
          kms_key: "alias/n3rvv-spark-vault"

      # Streamable media (CDN/HLS/DASH) for playback.
      - kind: "stream"
        name: "governor-demo"
        mime: "application/vnd.apple.mpegurl"  # or application/dash+xml
        uri: "https://cdn.n3rvv.com/demo/run-demo.m3u8"
        poster: "https://cdn.n3rvv.com/demo/poster.jpg"
        duration_sec: 92
        codec: "h264,aac"

      # Inline reference to code/query hosted elsewhere.
      - kind: "inline_uri"
        name: "athena_cost_query"
        mime: "text/x-sql"
        uri: "athena://workgroup/n3rvv_ops/db/costs/ceiling_projection.sql"

  scoring:
    routing_score:
      origin: "voice_input"
      suggested_dest: "forge"              # forge | cuboard | mycelium | finance_engine | sil | reticle | gateway
      confidence: 0.86
      threshold: 0.90
      source: "sil"                        # sil | user | reticle | gateway
      history_log:
        - attempt: 1
          dest: "forge"
          user_override: false
          at: "2025-08-30T21:44:20Z"
        - attempt: 2
          dest: "cuboards"
          user_override: true
          at: "2025-08-30T21:45:04Z"
    priority: "high"                       # low | medium | high | urgent
    ttl: "2025-09-15T00:00:00Z"            # review horizon (not deletion)
    signal_to_noise: 0.78                  # 0.0–1.0

  lifecycle:
    status: "in-progress"                  # idea | active | in-progress | merge_candidate | merged | evolved | completed | archived | discarded
    parent: "spk.ops.policy.2025-08.ceiling-root"
    children:
      - "spk.cu.board.task.2025-08.enable-budgets"
      - "spk.forge.lambda.2025-08.throttle-batch-jobs"
    history:
      - at: "2025-08-30T21:44:20Z"
        actor: "gateway"
        event: "created"
        note: "Captured via voice; auto-suggested Forge."
      - at: "2025-08-30T21:45:04Z"
        actor: "reticle"
        event: "edited"
        note: "User routed to CuBOARD for task breakdown."
      - at: "2025-08-31T12:14:55Z"
        actor: "sil"
        event: "advice"
        note: "Similar to spk.finance.cost.2025-07."
    milestones:
      - { type: "status_transition", from: "idea", to: "in-progress", at: "2025-08-30T21:45:04Z" }
      - { type: "merge_candidate", sim_peer: "spk.finance.cost.2025-07", sim: 0.83, at: "2025-08-31T12:14:55Z" }
    outcome: null

  echolog:
    last_updated: "2025-08-31T12:14:55Z"
    last_advice:
      type: "merge_candidate"
      sim_peer: "spk.finance.cost.2025-07"
      sim_score: 0.83
      confidence: 0.78
      rationale: "High cosine similarity + shared tags [aws,cost]"
    milestones:
      - { type: "stale_candidate", at: "2025-09-16T00:00:00Z" }
    pointers:
      s3_uri: "s3://n3rvv-echo/2025/08/31/spk.ops.policy.2025-08.ceiling-root.ndjson"
      hot_index_id: "ddb#spk.ops.policy.2025-08.ceiling-root"

  security:
    classification: "internal"             # public | internal | confidential | restricted
    encryption:
      in_transit: true
      at_rest: true
      kms_key: "alias/n3rvv-spark-vault"
    processing_policy:
      allow_external_ai: false
      pii_present: false
      retention_policy: "retain"           # retain | rotate | redact
      bastion_mode_required: false

  opsn3rvv:
    cost_center: "mvp.vault.lite"
    telemetry_level: "standard"            # minimal | standard | verbose
    health_flags: []
    sil_advice:
      merge_candidates: ["spk.finance.cost.2025-07"]
      route_suggestion:
        dest: "cuboard"
        confidence: 0.79
    runbooks:
      - "arn:aws:ssm:us-east-1:123456789012:document/Ops-EnableBudgets"
    controls:
      cost_ceiling_usd: 150
      soft_threshold_pct: 0.85
      hard_stop_pct: 1.00
      throttling_targets:
        - "batch.preview.generator"
        - "dev-preview.static-builds"
      override_procedure: "ticket://ops/change-req/CR-2025-0830-17"

ember:
  version: "5.3"
  license: "CC-BY-NC"
  generator: "reticle"
